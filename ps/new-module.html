<!doctype html><html lang="en">
<head><meta charset="UTF-8">
<link rel="STYLESHEET" href="../main.css" type="text/css">
<title>New-Module | PowerShell | SS64.com</title>
</head><body><h1>New-Module</h1> 
<p>Create a new dynamic module that exists only in memory.</p>
<pre>Syntax
      New-Module [-ScriptBlock] <i>ScriptBlock</i> [-ArgumentList <i>Object</i>[]] [-AsCustomObject]
         [-Cmdlet <i>String</i>[]] [-Function <i>String</i>[]] [-ReturnResult] [<a href="common.html"><i>CommonParameters</i></a>]

      New-Module [-Name] <i>String</i> [-ScriptBlock] <i>ScriptBlock</i> [-ArgumentList <i>Object</i>[]]
         [-AsCustomObject] [-Cmdlet <i>String</i>[]] [-Function <i>String</i>[]] [-ReturnResult] [<a href="common.html"><i>CommonParameters</i></a>]

Key
   -ArgumentList <i>Object</i>[]
       Specifies arguments (parameter values) that are passed to the script block.

   -AsCustomObject
       Returns a custom object that represents the dynamic module. The module members are implemented as script 
       methods of the custom object, but they are not imported into the session. You can save the custom object in a 
       variable and use dot notation to invoke the members.

       If the module has multiple members with the same name, such as a function and a variable that are both named 
       "A," only one member with each name is accessible from the custom object.

   -Cmdlet <i>String</i>[]
       Exports only the specified cmdlets from the module into the current session. Enter a comma-separated list of 
       cmdlets. Wildcard characters are permitted. By default, all cmdlets in the module are exported.

       You cannot define cmdlets in a script block, but a dynamic module can include cmdlets if it imports the 
       cmdlets from a binary module.

   -Function <i>String</i>[]
       Exports only the specified functions from the module into the current session. Enter a comma-separated list of 
       functions. Wildcard characters are permitted. By default, all functions defined in a module are exported.
        
   -Name <i>String</i>
       Specifies a name for the new module. You can also pipe a module name to New-Module.

       The default value is an autogenerated name that begins with "__DynamicModule_" and is followed by a GUID that 
       specifies the path to the dynamic module.

   -ReturnResult
       Runs the script block and returns the script block results instead of returning a module object.

   -ScriptBlock <i>ScriptBlock</i>
       Specifies the contents of the dynamic module. Enclose the contents in braces ( { } ) to create a script block. 
       This parameter is required.

   <a href="common.html">CommonParameters</a>:
       -Verbose, -Debug, -ErrorAction, -ErrorVariable, -WarningAction, -WarningVariable,
       -OutBuffer -OutVariable.</pre>
<p>The New-Module cmdlet creates a dynamic module from a script block. The members of the dynamic module, such as functions and variables, are immediately available in the session and remain available until you close the session.</p>
<p>Like static modules, by default, the cmdlets and functions in a dynamic module are exported and the variables and aliases are not. You can use <a href="export-modulemember.html">Export-ModuleMember</a> and the parameters of New-Module to override the defaults.</p>
<p>Dynamic modules are not returned by <a href="get-module.html">Get-Module</a>, but the members that they export are returned by  <a href="get-command.html">Get-Command</a>.</p>
<p>Standard <a href="get-alias.html">Aliases</a> for New-Module:<span class="code"> <b>nmo</b></span></p>
<p><b>Examples</b></p>
<p>Create a new dynamic module with a function called &quot;Hello&quot;. The command returns a module object that represents the new dynamic module:</p>
<p><span class="code">PS C:\&gt; new-module -scriptblock {function Hello {&quot;Hello!&quot;}}</span><br>
<br>
Create a new dynamic module, and also, use <a href="export-modulemember.html">Export-ModuleMember</a> to export a variable into the current session. Without the Export-ModuleMember command, only the function is exported:</p>
<pre>PS C:\> New-Module -scriptblock <b>{</b>$SayHelloHelp="Type 'SayHello', a space, and a name.";
                                 function SayHello ($name) { 
                                          "Hello, $name" };
                     Export-ModuleMember -function SayHello -Variable SayHelloHelp<b> }</b>

PS C:\> $SayHelloHelp
 Type 'SayHello', a space, and a name.

PS C:\> SayHello Jeffrey
 Hello, Jeffrey</pre>
<p> for more examples see: get-help New-Module -examples</p>
<p class="quote"><i>&ldquo;If we do not find anything pleasant, at least we shall find something new&rdquo; ~</i><i>Voltaire</i></p>
<p><b>Related:</b></p>
<p><a href="import-module.html">Import-Module</a> - Add a module to the session <br>
<a href="new-module.html">New-Module</a> - Create a new dynamic module (only in memory) <br>
<a href="remove-module.html">Remove-Module</a> - Remove a module from the current session</p></body>
</html>

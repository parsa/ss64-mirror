<!doctype html><html lang="en">
<head><meta charset="UTF-8">
<link rel="STYLESHEET" href="../main.css" type="text/css">
<title>DiskPart - Partition a disk | Windows CMD | SS64.com</title>
</head><body><h1>DiskPart</h1> 
<p>Disk Administration, Partition a disk. This page documents the Windows 7/8/2008/2012 R2 version of Diskpart. </p>
<pre>Syntax
      DISKPART<br>
Commands you can issue at the DISKPART prompt:

 ACTIVE  Set the current in-focus partition to be the system partition.

 ADD     Add a mirror to a simple mirror
            ADD disk=<i>n</i> [align=<i>n</i>] [wait] [<abbr title="For scripting only. When an error is encountered, DiskPart continues to process commands as if the error did not occur.">noerr</abbr>]

 ASSIGN  Assign a drive letter or mount point to the volume with focus.
         If no drive letter or mount point is specified, the next available drive letter is assigned.
            ASSIGN [{LETTER=<i>D</i>  | mount=<i>path</i>}] [<abbr title="For scripting only. When an error is encountered, DiskPart continues to process commands as if the error did not occur.">noerr</abbr>]

 ATTACH  Mount a virtual hard disk (VHD) so that it appears on the host computer as a local hard disk drive. 
            ATTACH vdisk [readonly] { [sd=<a href="https://technet.microsoft.com/en-us/library/gg252595.aspx"><i>SDDL</i></a>] | [usefilesd] } [<abbr title="For scripting only. When an error is encountered, DiskPart continues to process commands as if the error did not occur.">noerr</abbr>]

 ATTRIBUTES  Display, set, or clear the attributes of a disk or volume:
            ATTRIBUTES DISK [{set | clear}] [readonly] [noerr]<br>            ATTRIBUTES VOLUME [{set | clear}] [{hidden | readonly | nodefaultdriveletter | shadowcopy}] [<abbr title="For scripting only. When an error is encountered, DiskPart continues to process commands as if the error did not occur.">noerr</abbr>]

 AUTOMOUNT Enable or disable the automount feature:
            AUTOMOUNT [enable] [disable] [scrub] [<abbr title="For scripting only. When an error is encountered, DiskPart continues to process commands as if the error did not occur.">noerr</abbr>]

 BREAK   Break a mirror set
            BREAK disk=<i>n</i> [nokeep] [<abbr title="For scripting only. When an error is encountered, DiskPart continues to process commands as if the error did not occur.">noerr</abbr>]

 CLEAN   Remove any and all partition or volume formatting from the disk with focus, 'all' will Zero the disk.
            CLEAN [all]

 COMPACT VDISC   Reduce the physical size of a dynamically expanding virtual hard disk (VHD) file.

 CONVERT Convert a disk from one disk type to another:
            CONVERT basic  [<abbr title="For scripting only. When an error is encountered, DiskPart continues to process commands as if the error did not occur.">noerr</abbr>]
            CONVERT dynamic [<abbr title="For scripting only. When an error is encountered, DiskPart continues to process commands as if the error did not occur.">noerr</abbr>]
            CONVERT gpt [<abbr title="For scripting only. When an error is encountered, DiskPart continues to process commands as if the error did not occur.">noerr</abbr>]
            CONVERT mbr [<abbr title="For scripting only. When an error is encountered, DiskPart continues to process commands as if the error did not occur.">noerr</abbr>]

 CREATE  Create a volume, partition or virtual disk:
            CREATE partition efi [size=<i>n</i>] [offset=<i>n</i>] [<abbr title="For scripting only. When an error is encountered, DiskPart continues to process commands as if the error did not occur.">noerr</abbr>]
            CREATE partition extended [size=<i>n</i>] [offset=<i>n</i>] [align=<i>n</i>] [<abbr title="For scripting only. When an error is encountered, DiskPart continues to process commands as if the error did not occur.">noerr</abbr>]
            CREATE partition logical [size=<i>n</i>] [offset=<i>n</i>] [align=<i>n</i>] [<abbr title="For scripting only. When an error is encountered, DiskPart continues to process commands as if the error did not occur.">noerr</abbr>]
            CREATE partition msr [size=<i>n</i>] [offset=<i>n</i>] [<abbr title="For scripting only. When an error is encountered, DiskPart continues to process commands as if the error did not occur.">noerr</abbr>]
            CREATE partition primary [size=<i>n</i>] [offset=<i>n</i>] [id={ <i>byte</i> | <i>guid</i> }] [align=<i>n</i>] [<abbr title="For scripting only. When an error is encountered, DiskPart continues to process commands as if the error did not occur.">noerr</abbr>]

            CREATE volume raid [size=<i>n</i>] disk=<i>n</i>,<i>n</i>,<i>n</i>[,<i>n</i>,...] [align=<i>n</i>] [<abbr title="For scripting only. When an error is encountered, DiskPart continues to process commands as if the error did not occur.">noerr</abbr>]
            CREATE volume simple [size=<i>n</i>] [disk=<i>n</i>] [align=<i>n</i>] [<abbr title="For scripting only. When an error is encountered, DiskPart continues to process commands as if the error did not occur.">noerr</abbr>]
            CREATE volume stripe [size=<i>n</i>] disk=<i>n</i>,<i>n</i><i></i>[,<i>n</i>,...] [align=<i>n</i>] [<abbr title="For scripting only. When an error is encountered, DiskPart continues to process commands as if the error did not occur.">noerr</abbr>]
            CREATE volume mirror [size=<i>n</i>] disk=<i>n</i>,<i>n</i><i></i>[,<i>n</i>,...] [align=<i>n</i>] [<abbr title="For scripting only. When an error is encountered, DiskPart continues to process commands as if the error did not occur.">noerr</abbr>]

            CREATE vdisk file=<i>filepath</i> {[type={fixed|expandable}] | [parent=<i>filepath</i>] | [source=<i>filepath</i>]}
                      [maximum=<i>n</i>] [sd=<i>SDDL</i>] [<abbr title="For scripting only. When an error is encountered, DiskPart continues to process commands as if the error did not occur.">noerr</abbr>]

 DELETE  Delete a partition, volume or a dynamic disk from the list of disks:
            DELETE disk [<abbr title="For scripting only. When an error is encountered, DiskPart continues to process commands as if the error did not occur.">noerr</abbr>] [override]
            DELETE partition [<abbr title="For scripting only. When an error is encountered, DiskPart continues to process commands as if the error did not occur.">noerr</abbr>] [override]
            DELETE volume [<abbr title="For scripting only. When an error is encountered, DiskPart continues to process commands as if the error did not occur.">noerr</abbr>]

 DETACH Stop the selected VHD from appearing as a local hard disk drive (Win7/2008 R2 only).
            DETACH vdisk [<abbr title="For scripting only. When an error is encountered, DiskPart continues to process commands as if the error did not occur.">noerr</abbr>]

 DETAIL  Provide details about an object:
            DETAIL Disk
            DETAIL Partition
            DETAIL volume

 EXIT    Exit Diskpart

 EXPAND  Expand the max size (in MB) available on a virtual disk (Win7/2008 R2 only).
            EXPAND vdisk maximum=<i>n</i>

 EXTEND  Extend a volume or partition with focus and its file system into free (unallocated) space on a disk.
            EXTEND [size=<i>n</i>] [disk=<i>n</i>] [noerr]
            EXTEND filesystem [noerr]

 FILESYSTEMS Display current and supported file systems on the volume (Use 'Select Volume' first)

 FORMAT  Format the system or pertition:
            FORMAT <b>[</b>{fs=&lt;ntfs|fat|fat32&gt;] [revision=<i>x.xx</i>] | recommended}<b>]</b> [label=<i>label</i>]
                      [<abbr title="Override the default Allocation Unit size.">unit</abbr>=<i>n</i>] [quick] [compress] [<abbr title="Force the volume to dismount first if necessary.">override</abbr>] [duplicate] [<abbr title="Return immediately while the operation is still in progress.">nowait</abbr>] [<abbr title="For scripting only. When an error is encountered, DiskPart continues to process commands as if the error did not occur.">noerr</abbr>]

 GPT     Assign attributes to the selected GUID partition table (GPT) partition:
            GPT attributes=<i>n</i>

 HELP [<i>command</i>]

 IMPORT  Import a foreign disk group into the disk group of the local computer:
            IMPORT [<abbr title="For scripting only. When an error is encountered, DiskPart continues to process commands as if the error did not occur.">noerr</abbr>]

 INACTIVE Mark a system/boot partition as inactive [don&rsquo;t boot], (use 'Select Partition' first)

 LIST    Display a list of objects:
           LIST Disk
           LIST Partition
           LIST Volume
           LIST vdisk  (Windows 7/Server 2008 R2 only)

 MERGE   Merge a child disk with its parents. depth=1 will merge with parent. (Windows 7/Server 2008 R2 only)
            MERGE vdisk depth=<i>n</i>

 OFFLINE Take an online disk or volume to the offline state, use 'Select Disk' first)
           OFFLINE disk [<abbr title="For scripting only. When an error is encountered, DiskPart continues to process commands as if the error did not occur.">noerr</abbr>]
           OFFLINE volume [<abbr title="For scripting only. When an error is encountered, DiskPart continues to process commands as if the error did not occur.">noerr</abbr>]

 ONLINE Take an offline disk or volume to the online state.
           ONLINE disk [<abbr title="For scripting only. When an error is encountered, DiskPart continues to process commands as if the error did not occur.">noerr</abbr>]
           ONLINE volume [<abbr title="For scripting only. When an error is encountered, DiskPart continues to process commands as if the error did not occur.">noerr</abbr>]

 RECOVER Refresh the state of all disks in a disk group, attempt to recover disks in an
          invalid disk group, and resynchronize mirrored volumes and RAID-5 volumes that have stale data.

 REM  (remark/comment)

 REMOVE Remove a drive letter or mount point from a volume:
           REMOVE letter=<i>E</i> [dismount] [<abbr title="For scripting only. When an error is encountered, DiskPart continues to process commands as if the error did not occur.">noerr</abbr>]  (Remove drive letter <i>E</i> from the in-focus partition)
           REMOVE mount=<i>path</i> [dismount] [<abbr title="For scripting only. When an error is encountered, DiskPart continues to process commands as if the error did not occur.">noerr</abbr>]  (Remove mount point from the in-focus partition)
           REMOVE all [dismount] [<abbr title="For scripting only. When an error is encountered, DiskPart continues to process commands as if the error did not occur.">noerr</abbr>]       (Remove ALL current drive letters and mount points)

 REPAIR  Repair a RAID-5 volume with a failed member by replacing with a specified dynamic disk:
           REPAIR disk=<i>n</i> [align=<i>kb</i>] [<abbr title="For scripting only. When an error is encountered, DiskPart continues to process commands as if the error did not occur.">noerr</abbr>]   (align = KB from disk beginning to the closest alignment boundary.)

 RESCAN  Locate new disks and volumes that have been added to the computer.
 RETAIN  Prepare an existing dynamic simple volume to be used as a boot or system volume.

 SAN     Display or set the SAN policy for the currently booted OS.
           SAN [policy={<abbr title="All newly discovered disks will be brought online and made read/write. (Don't use for clusters)">OnlineAll</abbr> | <abbr title="All newly discovered disks except the startup disk will be offline and read-only by default.">OfflineAll</abbr> | <abbr title="All newly discovered disks that do not reside on a shared bus (such as SCSI and iSCSI) are brought online and made read-write. Disks that are left offline will be read-only by default.">OfflineShared</abbr>}] [<abbr title="For scripting only. When an error is encountered, DiskPart continues to process commands as if the error did not occur.">noerr</abbr>]

 SELECT  Shift the focus to an object:
           SELECT Disk={ <i>n</i> | <i>diskpath</i> | system | next }
           SELECT Partition={ <i>n</i> | <i>d </i>}   (Volume number or Drive letter)
           SELECT Volume={ <i>n</i> | <i>d </i>} [<abbr title="For scripting only. When an error is encountered, DiskPart continues to process commands as if the error did not occur.">noerr</abbr>] (Volume number or Drive Letter)
           SELECT vdisk file=<i>fullpath</i> [<abbr title="For scripting only. When an error is encountered, DiskPart continues to process commands as if the error did not occur.">noerr</abbr>]

 SETID   Change the partition type for the partition with focus (for OEM use):
           SET ID={ <i>byte</i> | <i>GUID</i> } [override] [noerr]

 SHRINK  Reduce the size of the selected volume:
           SHRINK [desired=<i>n</i>] [minimum=<i>n</i>] [<abbr title="Return immediately while the operation is still in progress.">nowait</abbr>] [<abbr title="For scripting only. When an error is encountered, DiskPart continues to process commands as if the error did not occur.">noerr</abbr>]  (Reduce the size of the in-focus volume)<br>           SHRINK <abbr title="Returns the maximum amount of space in MB by which the volume can be reduced.">querymax</abbr> [noerr]

 UNIQUEID Display or set the GUID partition table identifier or MBR signature for
          the (basic or dynamic) disk with focus:
           UNIQUEID disk [id={<i>dword</i> | <i>GUID</i>}] [<abbr title="For scripting only. When an error is encountered, DiskPart continues to process commands as if the error did not occur.">noerr</abbr>]
<b>
Commands to Manage Basic Disks:</b>

 ASSIGN MOUNT=<i>path</i>  (Choose a mount point path for the volume)

 CREATE PARTITION Primary Size=50000  (50 GB)
 CREATE PARTITION Extended Size=25000
 CREATE PARTITION logical Size=25000
 DELETE Partition
 EXTEND Size=10000
 GPT attributes=<i>n</i>   (assign GUID Partition Table attributes)
 SET id=<i>byte</i>|<i>GUID</i> [override] [noerr]   (Change the partition type)

<b>Commands to Manage Dynamic Disks:</b>

 ADD disk=<i>n</i>   (Add a mirror to the in-focus SIMPLE volume on the specified disk
               see 'Diskpart Help' for more.)
 BREAK disk=<i>n</i>  (Break the current in-focus mirror)
 CREATE VOLUME Simple Size=<i>n</i> Disk=<i>n</i>
 CREATE VOLUME Stripe Size=<i>n</i> Disk=<i>n</i>,<i>n</i>,...
 CREATE VOLUME Raid Size=<i>n</i> Disk=<i>n</i>,<i>n</i>,...
 DELETE DISK
 DELETE PARTITION
 DELETE VOLUME
 EXTEND Disk=<i>n</i> [Size=<i>n</i>]
 EXTEND Filesystem [noerr]
 IMPORT [noerr]   (Import a foreign disk group, use 'Select disk' first)
 RECOVER [noerr]  (Refresh disk pack state, attempt recovery on an invalid pack,
                   &amp; resynchronize stale plex/parity data.)
 REPAIR disk=<i>n</i> [align=<i>n</i>] [noerr]  (Repair the RAID-5 volume with focus, replace with the specified dynamic disk)
 RETAIN   (Prepare an existing dynamic simple volume to be used as a boot or system volume)</pre>
<p>When setting up a new drive, create in this order: Create Partition, Format drive, Assign drive letter.</p>
<p>The diskpart commands can be placed in a text file (one command per line) and
used  as an input file to diskpart.exe:</p>
<pre>DiskPart.exe &lt; myscript.txt
</pre>
<p>When selecting a volume or partition, you can use either the number or drive letter or the mount point path.</p>
<p>The Windows GUI interface can also be used to assign a mount-point folder path to a drive. In <span class="code">Disk Manager</span>, right-click the partition or volume, and  click <span class="code">Change Drive Letter and Paths</span>,     then click <span class="code">Add</span> and then type the path to an empty folder on an NTFS volume.</p>
<p>The Windows <a href="syntax-recovery.html">Recovery Console</a>, includes a simplified DISKPART command. It only provides functionality for adding and deleting partitions, but not for setting an active partition.</p>
<p>Always  back up the hard disk before running diskpart.</p>
<p> Examples:<br>
</p>
<pre>
SELECT DISK=0
CREATE PARTITION PRIMARY
SELECT PARTITION=1
FORMAT FS=NTFS LABEL="New Volume" QUICK<br>ASSIGN LETTER=E
EXIT </pre>
<p>The default SAN policy in Windows Server 2008 / R2 is now VDS_SP_OFFLINE_SHARED for all non boot SAN disks.<br>
This  means that the disks will be offline at server startup (even if the drive contains a paging file).</p>
<p>This Disk Management error message indicates that the drive is offline:</p>
<blockquote>
<p class="code">&quot;the disk is offline because of policy set by an administrator&quot;.</p>
</blockquote>
<p>Query the current SAN policy to see if it is Offline Shared</p>
<p class="code">DISKPART.EXE <br>
DISKPART&gt; san <br>
SAN Policy : Offline Shared</p>
<p>To manually bring the disks online: <br>
<span class="code">Computer Management &gt; Storage &gt; Disk Management</span>, right-click the disk and choose <span class="code">Online</span>.</p>
<p>If these are <b>not</b> part of a cluster, than an alternative is to make a SAN policy change,  select the offline disk, clear  its readonly flag and bring it online:</p>
<pre> DISKPART&gt; san policy=OnlineAll 
 DiskPart successfully changed the SAN policy for the current operating system. 
 
 DISKPART&gt; LIST DISK 
 Disk ### Status        Size    Free    Dyn Gpt
 -------- ------------- ------- ------- --- ---
 Disk 0   Online         80 GB     0 B
 * Disk 1 Offline        20 GB  1024 KB 
 
 DISKPART&gt; select disk 1 
 Disk 1 is now the selected disk. 
 
 DISKPART&gt; ATTRIBUTES DISK CLEAR READONLY</pre>
<pre> DISKPART&gt; ONLINE DISK
 DiskPart successfully onlined the selected disk.</pre>
<p><i class="quote">&ldquo;Divide et impera&rdquo; ~ Latin saying (Divide and conquer)</i><br>
<br>
Related:<br>
<br>
<a href="https://support.microsoft.com/kb/325590">Q325590</a> - Use Diskpart.exe to extend a data volume<br>
<a href="fsutil.html">FSUTIL</a> - File and Volume utilities<br>
<a href="diskshadow.html">DISKSHADOW</a> - Volume Shadow Copy Service<br>
PowerShell equivalents: <span class="code">get-disk, set-partition, get-volume </span><br>
Equivalent bash command (Linux): <a href="../bash/fdisk.html">fdisk</a> - Partition table manipulator for Linux</p></body>
</html>
